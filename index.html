<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transparent Electron App</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <img id="logo" src="./TrovinnLogo-01.png" alt=""
        style="width: 100%; height: 100%; object-fit: contain; pointer-events: auto; cursor: grab; user-select: none; -webkit-user-drag: none;">
    <script>
        const { ipcRenderer } = require('electron');
        const logo = document.getElementById('logo');
        let isDragging = false;
        let offsetX, offsetY;

        // Logo variants
        const logos = [
            './TrovinnLogo-01.png',
            './TrovinnLogo-02.png',
            './TrovinnLogo-03.png',
            './TrovinnLogo-04.png',
            './TrovinnLogo-05.png'
        ];
        let currentLogoIndex = 0;

        logo.addEventListener('dblclick', () => {
            currentLogoIndex = (currentLogoIndex + 1) % logos.length;
            logo.src = logos[currentLogoIndex];
        });

        logo.addEventListener('mouseenter', () => {
            ipcRenderer.send('set-ignore-mouse-events', false);
        });

        logo.addEventListener('mouseleave', () => {
            if (!isDragging) {
                ipcRenderer.send('set-ignore-mouse-events', true, { forward: true });
            }
        });

        logo.addEventListener('mousedown', (e) => {
            isDragging = true;
            logo.style.cursor = 'grabbing';
            offsetX = e.clientX;
            offsetY = e.clientY;
        });

        window.addEventListener('mousemove', (e) => {
            if (isDragging) {
                const x = Math.round(e.screenX - offsetX);
                const y = Math.round(e.screenY - offsetY);
                ipcRenderer.send('window-move', { x, y });
            }
        });

        window.addEventListener('mouseup', (e) => {
            if (isDragging) {
                isDragging = false;
                logo.style.cursor = 'grab';

                // Re-evaluate click-through status
                // Since the window IS the logo now, if we are inside, we are inside.
                // If we are outside (mouseup happened outside?), we might need to reset.
                // But mouseleave handles the exit.
            }
        });
    </script>
</body>

</html>